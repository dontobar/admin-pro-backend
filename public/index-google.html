<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-signin-client_id" content="336467152360-o1sno0tq30qfpjimdc4ck2hnriljrqjr.apps.googleusercontent.com">
    <title>Demo Login</title>
</head>
<body>
    <h1>Google Sign-in</h1>


<button id="google_signout">
  Signout
</button>


  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <script>
      function handleCredentialResponse(response) {


          const body = {id_token:response.credential};

          //fetch('http://localhost:3000/api/login/google',{
            fetch('https://restserver-node-nuevo.herokuapp.com/api/auth/google',{
              method:'POST',
              headers:{
                  'Content-Type':'application/json'
              },
              body:JSON.stringify(body)
          })
              .then(resp => resp.json())
              .then(resp =>{
                  console.log(resp)
                  localStorage.setItem('email',resp.usuario.correo)
              })
              .catch(console.warn);
      }

      const button = document.getElementById('google_signout')
      button.onclick = () =>{
          console.log( google.accounts.id)
          google.accounts.id.disableAutoSelect()

          google.accounts.id.revoke(localStorage.getItem('email'),done =>{
              localStorage.clear();
              location.reload();
          });
      }
    </script>
        


</body>
</html>